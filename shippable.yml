language: node_js
node_js:
  - "node"

build:
  pre_ci_boot:
    image_name: drydock/u16nodall
    image_tag: v6.3.4
    pull: true
  cache: true
  cache_dir_list:
    - $SHIPPABLE_BUILD_DIR/node_modules
  ci:
    - ls -l /tmp/ssh
    - java -version
    - npm install --unsafe-perm
    - npm run lint
    - npm run build
  on_success:
    - echo "branch - ${BRANCH}"
    - echo "IS_PULL_REQUEST - ${IS_PULL_REQUEST}"
    - if [ "$BRANCH" == "yumetodo/master" ] && [ "${IS_PULL_REQUEST}" != "true" ]; then ./tools/shippable_deploy.sh; fi

notifications:
  email:
    on_success: change
    on_failure: always

integrations:
  key:
    - integrationName: shippable2githubssh
      type: ssh-key
